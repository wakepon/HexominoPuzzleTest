# 新パターン案 第1弾（30種）

## ステータス: アイデア段階

既存9種のパターンとの差別化と、新レリック案（NewRelics1.md）とのシナジーを意識した30種の新パターンを提案する。

---

## デザイン方針

### 既存パターンの分類

| 分類 | パターン | 効果先 |
|---|---|---|
| ブロック点(A)加算 | enhanced(+2), aura(隣接+1), charge(蓄積), combo(2^n-1) | スコア(A) |
| 列点(B)加算 | moss(端辺数), lucky(10%で×2) | スコア(B) |
| 配置ルール変更 | feather(重ね置き), nohand(ハンド不消費) | ルール |
| ネガティブ | obstacle(消去不可) | 妨害 |

### 新パターンで埋める設計空間

1. **ボード状態変更型**: 消去時にボードの状態を変化させる（既存にない）
2. **A-B橋渡し型**: ブロック点と列点の両方に影響する（既存にない）
3. **時間経過型**: 累積・成長する効果（chargeに似るが異なる軸）
4. **位置依存型**: ボード上の位置で効果が変わる（mossに似るが異なる条件）
5. **条件付きネガティブ型**: デメリットとメリットの両面を持つ（obstacleの発展系）

---

## 新パターン一覧

---

### P01: 爆弾ブロック (bomb)

| 項目 | 値 |
|---|---|
| type | `bomb` |
| name | 爆弾ブロック |
| symbol | 💣 |
| isNegative | false |
| 効果タイミング | 消去時 |
| ショップ出現 | 可能 |
| description | 消去時、隣接する上下左右のブロックも追加消去 |

**効果詳細**: ライン消去の対象にbombパターンのセルが含まれる場合、そのセルに上下左右で隣接するfilled状態のセルも追加で消去対象に含める。追加消去されたセルもブロック点(A)のbaseBlocksにカウントされる。追加消去されたセルのパターン/シール効果も通常通り発動する。

- 追加消去は1段階のみ（追加消去されたセルからさらに連鎖はしない）
- obstacle・stoneは追加消去の対象外
- multiシール付きbombは2回分として処理（上下左右の計8方向...ではなく、通常の4方向を2回処理=同じ）→ multiの効果は他パターンと同様にパターン効果2倍化として、追加消去ブロック数×2にする

**デザイン意図**: 「ライン上にないブロックも巻き込む」という既存にない効果。ラインが完成しにくい盤面でもスコアを稼げる。ただし、chargeブロックなどの「残しておきたいブロック」の隣に置くと意図せず消去してしまうリスクがある。

**シナジー**:
- ビッグバン（R08: 12ブロック以上消去で×2.5）→ 爆弾で追加消去してブロック数を稼ぐ
- 群衆（R05: 3種以上のblockSetIdでブロック点×2）→ 追加消去で異なるblockSetIdを巻き込む
- 雪だるま（R15: 累計消去ブロックで成長）→ 追加消去でカウントが早く溜まる

**実装複雑度**: 中。消去対象セル収集ロジック（`getCellsToRemoveWithFilter`）の拡張が必要。

---

### P02: プリズムブロック (prism)

| 項目 | 値 |
|---|---|
| type | `prism` |
| name | プリズムブロック |
| symbol | 🔷 |
| isNegative | false |
| 効果タイミング | 消去時 |
| ショップ出現 | 可能 |
| description | 消去ライン数をブロック点にも加算 |

**効果詳細**: 消去対象セルにprismパターンのセルが1つでも含まれる場合、消去ライン数（行+列の合計）をブロック点(A)に加算する。prismセルが複数あっても加算は1回のみ（重複しない）。multiシール付きprismがある場合は加算量が2倍。

例: 2ライン消去 + prism1個 → ブロック点に+2

**デザイン意図**: A×B方式のスコア計算で、B（列点）の基になるライン数をA（ブロック点）にも反映させる、AとBを橋渡しする独自の存在。多ライン消去の価値をA側でも増幅する。

**シナジー**:
- chain_master（2ライン以上で列点×1.5）→ 多ライン消去のA側ボーナスにもなる
- トリプルスレット（R12: 3ライン以上で×3）→ 3ライン消去でブロック点+3かつ列点×3
- 十字路（R07: 縦横同時で列点×2）→ 十字消しの恩恵がA側にも波及

**実装複雑度**: 低。PatternEffectHandlerにライン数参照のロジックを追加するだけ。

---

### P03: エコーブロック (echo)

| 項目 | 値 |
|---|---|
| type | `echo` |
| name | エコーブロック |
| symbol | 🔊 |
| isNegative | false |
| 効果タイミング | 消去時 |
| ショップ出現 | 可能 |
| description | 前回の消去スコアの10%をブロック点に加算 |

**効果詳細**: 消去対象セルにechoパターンのセルが含まれる場合、そのラウンド内で前回のライン消去で獲得した最終スコアの10%（切捨て）をブロック点(A)に加算する。ラウンド内の最初の消去では前回スコアが0のため効果なし。echoセルが複数あっても加算は1回（ただしmultiシール付きで2倍）。

例: 前回の消去で50点獲得 → 今回echoで+5がブロック点に加算

**デザイン意図**: 連続消去を促す「時間経過型」パターン。前回スコアが大きいほど次の消去も大きくなる正のフィードバックループ。連射ビルド（毎手消去を継続）との強いシナジー。

**シナジー**:
- rensha（毎手消去で累積倍率）→ 連続消去の恩恵が二重に
- 忍耐（R14: 3手溜めてから消去で×3）→ 大スコアの後のエコーが大きい
- 雪だるま（R15: ラウンド内累計で成長）→ 後半ほどエコー量も増加

**実装複雑度**: 低〜中。ラウンド内の前回スコアをGameStateに保持する必要あり。

---

### P04: 結晶ブロック (crystal)

| 項目 | 値 |
|---|---|
| type | `crystal` |
| name | 結晶ブロック |
| symbol | 💎 |
| isNegative | false |
| 効果タイミング | 消去時 |
| ショップ出現 | 可能 |
| description | 行と列の交差点にある場合、ブロック点+10 |

**効果詳細**: 消去対象セルのうちcrystalパターンを持つセルが、完成した行と完成した列の両方に含まれている場合（交差点）、ブロック点(A)に+10する。交差点でない場合は効果なし。multiシール付きで+20。

例: 行2と列3が同時に完成 → (2,3)にcrystalブロックがあれば+10

**デザイン意図**: 「行と列の交差点にcrystalを置く」という明確な目標を与える位置依存型パターン。十字消しの精度と計画性を報いる。通常のenhanced(+2)に比べて条件が厳しいが報酬が大きい。

**シナジー**:
- 十字路（R07: 縦横同時消去で列点×2）→ 十字消しを狙う明確なビルド
- センターコア（R04: 中央4マスで+8）→ 中央の交差点にcrystalを配置
- arrowシール（行/列完成で+10）→ crystal+arrowで交差点が超高得点

**実装複雑度**: 低。消去時にcompletedLinesのrows/columnsとセル位置を照合するだけ。

---

### P05: 影ブロック (shadow)

| 項目 | 値 |
|---|---|
| type | `shadow` |
| name | 影ブロック |
| symbol | 👤 |
| isNegative | false |
| 効果タイミング | 消去後（ボード状態変更） |
| ショップ出現 | 可能 |
| description | 消去後その位置に影を残す。影の上に配置するとブロック点+3 |

**効果詳細**: shadowパターンのセルが消去された後、そのセルの位置に「影マーカー」を設定する（`hasShadow: true`）。影マーカーのあるセルにブロックを配置した場合、そのピース全体のブロック点に+3が加算される（配置時に記録し、消去時のスコアに反映）。影マーカーは使用されると消える。multiシール付きshadowでは影マーカーが2回分使用可能（2回まで+3ボーナスが得られる）。

**デザイン意図**: 消去と配置のサイクルに新しい意味を持たせる「ボード状態変更型」パターン。「前回消去した場所に次のブロックを置く」という配置計画を促す。既存のどのパターンとも異なる、時空間をまたぐ効果。

**シナジー**:
- 全消しビルド → 全消し後に影だらけのボードが残り、次の配置が高得点に
- featherパターン → 影マーカーの位置に重ね置きで効率的にボーナス獲得
- エッジランナー（R03）/ センターコア（R04）→ 影の位置が外周/中央なら二重ボーナス

**実装複雑度**: 中。Cellに`hasShadow`プロパティ追加、配置処理での影マーカーチェック、消去後の影設定ロジックが必要。

---

### P06: 蔓ブロック (vine)

| 項目 | 値 |
|---|---|
| type | `vine` |
| name | 蔓ブロック |
| symbol | 🌿 |
| isNegative | false |
| 効果タイミング | 配置時（スコアは消去時に反映） |
| ショップ出現 | 可能 |
| description | 配置時、隣接する埋まったセルの数×1をブロック点に加算 |

**効果詳細**: vineパターンのピースを配置した際、ピースの各ブロックの上下左右で隣接するfilled状態のセル（同じピースの他のブロックは除く）の数をカウントし、その合計をブロック点(A)に加算する。この値は配置時に計算されて記録され、消去時のスコア計算で反映される。multiシール付きで2倍。

例: vineブロック(3セル)を配置、隣接する既存ブロック合計5個 → ブロック点+5

**デザイン意図**: 「密集した場所に配置する」ことを報いる配置型パターン。feather（重ね置き）やnohand（ハンド不消費）とは異なる配置報酬軸。盤面がある程度埋まった後半での配置が高得点になる。

**シナジー**:
- featherパターン → 密集地に重ね置きできるfeatherと組み合わせて高い隣接数を稼ぐ
- chargeパターン → charge蓄積+vine隣接ボーナスで「待ち」の価値が二重に
- 忍耐（R14: 3手溜めて消去で×3）→ 盤面を埋めてからvine+消去で爆発

**実装複雑度**: 中。配置時に隣接カウントを計算し、BlockDataまたはCellに記録する仕組みが必要。charge蓄積と類似のアーキテクチャ。

---

### P07: 連結ブロック (link)

| 項目 | 値 |
|---|---|
| type | `link` |
| name | 連結ブロック |
| symbol | 🔗 |
| isNegative | false |
| 効果タイミング | 消去時 |
| ショップ出現 | 可能 |
| description | 隣接するlinkブロック同士が消去されると、ペア数×4をブロック点に加算 |

**効果詳細**: 消去対象セルの中でlinkパターンを持つセル同士が上下左右で隣接している場合、隣接ペア数×4をブロック点(A)に加算する。同じペアは重複カウントしない。multiシール付きlinkは2カウント扱い。

例: 3つのlinkブロックが一列に並んで消去 → 2ペア → ブロック点+8
例: 4つのlinkブロックがL字に並んで消去 → 3ペア → ブロック点+12

**デザイン意図**: 「同じパターンのブロックを隣接させる」配置を促すパターン。comboパターン（同時消去数で指数的ボーナス）とは異なり、「位置関係」が重要。

**シナジー**:
- 紋様共鳴（R33: 同じパターン3つ以上で列点×2）→ linkを3つ以上並べて列点×2+隣接ボーナス
- auraパターン → auraは「別セットの」隣接で効果、linkは「同パターンの」隣接で効果。併用で隣接配置が二重に報われる
- コンボチェーン（R37: combo計算強化）→ comboとlinkの使い分け。comboは数、linkは位置

**実装複雑度**: 低〜中。消去対象セルのlink同士の隣接ペアをグラフ探索でカウント。

---

### P08: 収穫ブロック (harvest)

| 項目 | 値 |
|---|---|
| type | `harvest` |
| name | 収穫ブロック |
| symbol | 🌾 |
| isNegative | false |
| 効果タイミング | 消去時 |
| ショップ出現 | 可能 |
| description | ラウンド内でharvestブロックを消去した累計回数×2をブロック点に加算 |

**効果詳細**: ラウンド内でharvestパターンのブロックが消去された累計回数（harvestCounter）を記録する。消去対象にharvestブロックが含まれるたびにカウンターが+1された後、`harvestCounter × 2` をブロック点(A)に加算する。ラウンド開始時にカウンターリセット。multiシール付きで+1が+2カウントになる。

例: 1回目のharvest消去 → counter=1, +2 / 2回目 → counter=2, +4 / 3回目 → counter=3, +6

**デザイン意図**: 「成長するブロック点加算」。chargeが「他の配置で蓄積」するのに対し、harvestは「自分の消去回数で成長」する。デッキにharvest付きピースを複数入れ、何度も消去を繰り返すビルド。

**シナジー**:
- rensha（連続消去で列点累積）→ harvestのA成長+renshaのB成長で両方が育つ
- デッキシュリンカー（R18: デッキ少ないほど列点UP）→ harvest付きの少数精鋭デッキ
- 連射ビルド全般 → 毎手消去でharvestカウンターが上がり続ける

**実装複雑度**: 低。RelicMultiplierStateに類似した`harvestCounter`をGameStateに追加。

---

### P09: 炎ブロック (flame)

| 項目 | 値 |
|---|---|
| type | `flame` |
| name | 炎ブロック |
| symbol | 🔥 |
| isNegative | false |
| 効果タイミング | 消去時 |
| ショップ出現 | 可能 |
| description | 同時消去のflameブロック数nに応じて列点に2^n加算 |

**効果詳細**: 消去対象セルに含まれるflameパターンのブロック数nに応じて、列点(B)に `2^n` を加算する。multiシール付きflameは2カウント扱い。

| flameブロック数 | 列点加算 |
|---|---|
| 1 | +2 |
| 2 | +4 |
| 3 | +8 |
| 4 | +16 |
| 5 | +32 |

**デザイン意図**: comboパターンの「列点版」。comboがブロック点(A)に指数的ボーナスを加えるのに対し、flameは列点(B)に指数的ボーナスを加える。A×B方式のため、comboとflameを同時に消去するとA×Bの両方が指数的に伸びる。

**シナジー**:
- comboパターン → AにcomboのΔ、Bにflameの2^n。同時消去でA×Bが爆発的に増大
- コンボチェーン（R37: combo計算強化）→ combo+flameの「指数ビルド」が完成
- 紋様共鳴（R33: 同一パターン3+で列点×2）→ flame3個で列点+8に加えて×2
- mossパターン → 列点(B)に加算する仲間。mossは端位置、flameは数量で差別化

**実装複雑度**: 低。comboBonus計算とほぼ同じロジック。PatternEffectHandlerにflameBonus計算を追加。

---

### P10: 氷ブロック (ice)

| 項目 | 値 |
|---|---|
| type | `ice` |
| name | 氷ブロック |
| symbol | 🧊 |
| isNegative | true |
| 効果タイミング | 消去判定時 + 消去時 |
| ショップ出現 | 不可（ボスラウンドなどシステム配置） |
| description | 1回目のライン完成では消去されず「ひび」が入る。2回目で消去され、ブロック点+5 |

**効果詳細**: iceパターンのセルは`isNegative: true`だが、obstacleとは異なる処理をする。

- **初回のライン完成**: iceセルは消去されない。代わりにセルの`iceCracked`フラグが`true`になる（「ひび」状態）。ライン完成判定自体はiceセルをfilledとしてカウントする。
- **2回目のライン完成**: `iceCracked: true`のiceセルは通常通り消去可能。消去時にブロック点(A)に+5を加算する。multiシール付きで+10。
- **ひびリセット**: ラウンド終了時にリセット。

**デザイン意図**: obstacleの発展系として、「一時的な障害」を導入する。obstacleは絶対に消せないが、iceは「2回消去を通す」ことで消せる。しかも消去時にはボーナスが得られるため、ネガティブをポジティブに転換する達成感がある。

**ショップ不出現の理由**: ネガティブパターンのため、ボスラウンドの特殊条件やイベントでシステムから配置される。obstacle（おじゃまブロック）の代替/追加として使用。

**シナジー**:
- 全消しビルド → iceを2回消去して全消しを狙う高難度チャレンジ
- bomb（P01: 隣接ブロック追加消去）→ bombでiceのひびを割る...ではなく、bombの追加消去対象にice(cracked)が含まれると消去可能
- 台本レリック → 台本の指定ラインにiceがある場合、2回揃える計画が必要

**実装複雑度**: 中。Cellに`iceCracked`プロパティ追加、ライン消去判定でice状態に応じた処理分岐が必要。

---

## パターン分類サマリー

### 既存パターン（9種）+ 新パターン（10種）= 全19種

| 分類 | 既存 | 新規 |
|---|---|---|
| ブロック点(A)加算 | enhanced, aura, charge, combo | prism, crystal, vine, link, harvest |
| 列点(B)加算 | moss, lucky | flame |
| ボード状態変更 | — | bomb(追加消去), shadow(影マーカー) |
| 配置ルール変更 | feather, nohand | vine(配置時判定) |
| ネガティブ | obstacle | ice(一時的障害) |
| 時間経過/成長 | charge | echo(前回スコア参照), harvest(累計回数) |

### 効果タイミング分類

| タイミング | パターン |
|---|---|
| 消去時 | enhanced, lucky, combo, aura, moss, charge, **prism, echo, crystal, link, harvest, flame** |
| 配置時 | feather, nohand, **vine** |
| 消去後（ボード変更） | **bomb, shadow** |
| 消去判定時 | obstacle, **ice** |

---

## 新パターン × 既存レリックのシナジー表

| パターン | 特に相性の良い既存レリック | 理由 |
|---|---|---|
| bomb | chain_master, full_clear_bonus | 追加消去でライン数・消去数が増える |
| prism | chain_master, takenoko, kani | 多ライン消去がAにも反映 |
| echo | rensha | 連続消去で前回スコアが積み上がる |
| crystal | script | 台本の指定ラインの交差点にcrystalを置く |
| shadow | full_clear_bonus | 全消し後の影ボードが次の配置を強化 |
| vine | timing | 盤面が埋まった状態での高隣接数+タイミング倍率 |
| link | copy | linkの高ボーナスをコピーで倍増 |
| harvest | rensha, bandaid | 連続消去でharvest成長+rensha成長 |
| flame | single_line | 1ライン消去でも列点×3にflameの2^nが加算 |
| ice | (ボス条件) | obstacleの代替として |

## 新パターン × 新レリック（NewRelics1.md）のシナジー表

| パターン | 特に相性の良い新レリック | 理由 |
|---|---|---|
| bomb | ビッグバン(R08), 群衆(R05) | 追加消去で12ブロック/3セット超えを狙う |
| prism | 十字路(R07), トリプルスレット(R12) | 縦横消去・3ライン消去の恩恵がA側にも |
| echo | 雪だるま(R15), フィーバー(R09) | 後半加速ビルドの核 |
| crystal | 十字路(R07), センターコア(R04) | 中央交差点特化ビルド |
| shadow | エッジランナー(R03), 全消しビルド全般 | 影ボードの戦略的活用 |
| vine | 忍耐(R14), チャージ加速器(R35) | 盤面構築→一気消去ビルド |
| link | 紋様共鳴(R33), 紋様蒐集家(R01) | link特化ビルド |
| harvest | デッキシュリンカー(R18), 大食い(R17) | harvest付き少数精鋭デッキ |
| flame | コンボチェーン(R37), 紋様共鳴(R33) | A(combo)+B(flame)指数ビルド |
| ice | セカンドチャンス(R28) | 高難度ボスへの対応 |

---

---

## P11〜P30: 追加パターン（20種）

### 設計空間の拡張

P01〜P10で埋まっていない設計空間を特定し、以下のカテゴリで20種を追加する。

| カテゴリ | P01-P10 | P11-P30で追加 |
|---|---|---|
| A加算（盤面状態依存） | vine(隣接埋まり) | fertile, hollow, heavy |
| B加算 | flame(指数的) | beacon, crown, spark |
| メタパターン（他パターン強化） | — | mirror, catalyst, rainbow, amplifier |
| 経済（ゴールド） | — | gold_vein, treasure |
| 時間制約/変化 | echo, harvest | volatile, clay |
| ボード変更（新バリエーション） | bomb, shadow | seed |
| ネガティブ/リスク | ice | thorns, rust |
| 配置ルール変更 | — | phase, warp |

---

### P11: 肥沃ブロック (fertile)

| 項目 | 値 |
|---|---|
| type | `fertile` |
| name | 肥沃ブロック |
| symbol | 🌻 |
| isNegative | false |
| 効果タイミング | 消去時 |
| ショップ出現 | 可能 |
| description | 消去後の空きマス数×0.5をブロック点に加算 |

**効果詳細**: ライン消去後の盤面の空きマス数（6×6=36 - 残存filledセル数）を計算し、その値の半分（切捨て）をブロック点(A)に加算する。消去対象にfertileセルが1つでも含まれる場合に発動。複数あっても加算は1回。multiシール付きで加算量2倍。

例: 消去後に空きマスが20個 → ブロック点+10
例: 全消し（空き36個） → ブロック点+18

**デザイン意図**: 「盤面を空ければ空けるほど得」という全消しビルドとの強いシナジー。全消しボーナス（列点×5）がB側を強化するのに対し、fertileはA側を強化する。

**シナジー**:
- full_clear_bonus（既存: 列点×5）→ A(fertile)+B(全消し)の両方が最大化
- bomb(P01: 追加消去) → 爆弾で多く消すほど空きマスが増えてfertile効果UP
- shadow(P05) → 全消し後の影ボード+次のfertile消去で高得点

**実装複雑度**: 低。消去後のboard状態をカウントするだけ。

---

### P12: 空洞ブロック (hollow)

| 項目 | 値 |
|---|---|
| type | `hollow` |
| name | 空洞ブロック |
| symbol | ○ |
| isNegative | false |
| 効果タイミング | 消去時 |
| ショップ出現 | 可能 |
| description | 隣接する空きマスの数×2をブロック点に加算 |

**効果詳細**: 消去対象セルのうちhollowパターンを持つセルごとに、上下左右の隣接セルで空き状態（`filled: false`）のセル数をカウントし、`空きセル数 × 2` をブロック点(A)に加算する。ボード端の外側は空きとしてカウントしない。multiシール付きで加算量2倍。

例: hollowブロックの上下左右が全て空き → +8
例: hollowブロックが隅にあり、2辺がボード端、2辺が空き → +4

**デザイン意図**: mossパターンの対照的存在。mossは「端に接しているほど列点UP」だが、hollowは「空きに接しているほどブロック点UP」。mossと組み合わせると、角に配置したブロックが端接触+空き隣接の両方で得点を稼ぐ。

**シナジー**:
- mossパターン → 角や端に配置して「moss(B加算)+hollow(A加算)」の二重取り
- エッジランナー(R03: 外周ブロック+2) → 外周×hollow×mossの3重ボーナス
- 全消しビルド → 盤面が空いているほど隣接空きが多い

**実装複雑度**: 低。隣接セルの状態チェックのみ。auraの判定ロジックと類似。

---

### P13: 重量ブロック (heavy)

| 項目 | 値 |
|---|---|
| type | `heavy` |
| name | 重量ブロック |
| symbol | ⬛ |
| isNegative | false |
| 効果タイミング | 消去時 |
| ショップ出現 | 可能 |
| description | 配置したピースのブロック数をブロック点に加算 |

**効果詳細**: heavyパターンを持つピースが消去対象に含まれる場合、そのピースの元のブロック数（placedBlockSize: 1〜6）をブロック点(A)に加算する。同じheavyピースから複数セルが消去されても加算は1回。multiシール付きで2倍。

例: ヘキソミノ(6ブロック)のheavy → ブロック点+6
例: モノミノ(1ブロック)のheavy → ブロック点+1

**デザイン意図**: size_bonusレリック（サイズ別でブロック点+baseBlocks）と似ているが、パターンとして付与されるため、レリック枠を使わずにサイズボーナスを得られる。大きいピースほど恩恵が大きく、大ピースビルドを支援。

**シナジー**:
- size_bonus_5/6（既存: 大ピースでブロック点加算）→ heavy+サイズボーナスで大ピースが二重に強い
- ビッグラバー(R11: 5〜6ブロックで列点×1.5) → A(heavy)+B(ビッグラバー)
- 孤高(R06: 2セット以下でブロック点+baseBlocks) → 大ピースheavyで三重加算

**実装複雑度**: 低。配置時のplacedBlockSizeを参照するだけ。

---

### P14: 灯台ブロック (beacon)

| 項目 | 値 |
|---|---|
| type | `beacon` |
| name | 灯台ブロック |
| symbol | 🗼 |
| isNegative | false |
| 効果タイミング | 消去時 |
| ショップ出現 | 可能 |
| description | 盤面の残存ブロック数×0.3を列点に加算 |

**効果詳細**: ライン消去時にbeaconパターンのセルが消去対象に含まれる場合、消去前の盤面の残存filledセル数（消去対象を含む）× 0.3（切捨て）を列点(B)に加算する。beaconが複数あっても加算は1回。multiシール付きで2倍。

例: 盤面に20ブロック → 列点+6

**デザイン意図**: 「盤面が詰まっている状態での消去」を報いるパターン。fertileが「空きが多いほど有利」なのに対し、beaconは「埋まりが多いほど有利」。相反する2つの戦略を提示。

**シナジー**:
- vine(P06: 隣接埋まりセル数加算) → 密集配置ビルドで両方が活きる
- charge（既存: 他配置で蓄積）→ 盤面を埋めながらcharge蓄積+beacon列点
- 忍耐(R14: 3手溜めてから消去) → 盤面を埋めきってからbeacon+忍耐で一発

**実装複雑度**: 低。盤面のfilledセル数をカウントするだけ。

---

### P15: 王冠ブロック (crown)

| 項目 | 値 |
|---|---|
| type | `crown` |
| name | 王冠ブロック |
| symbol | 👑 |
| isNegative | false |
| 効果タイミング | 消去時 |
| ショップ出現 | 可能 |
| description | デッキ内で最大サイズのピースで消去時、列点+ピースサイズ |

**効果詳細**: crownパターンを持つピースのブロック数が、現在のデッキ内の最大ブロック数と一致する場合、列点(B)にそのブロック数を加算する。一致しない場合は効果なし。multiシール付きで加算量2倍。

例: デッキ最大がヘキソミノ(6)で、crownがヘキソミノに付いている → 列点+6
例: デッキ最大がテトロミノ(4)で、crownがトリミノに付いている → 効果なし

**デザイン意図**: 「デッキの最強ピース」にcrownを付与する動機。護符でcrownをヘキソミノに付ければ列点+6の安定ボーナス。デッキ圧縮で最大サイズを意識する戦略。

**シナジー**:
- ビッグラバー(R11: 5〜6ブロックで列点×1.5) → crown+ビッグラバーで大ピースの列点が大幅UP
- デッキシュリンカー(R18: デッキ少ないほど列点UP) → 大ピース+crownを残してデッキ圧縮
- 紋様の護符 → 最大サイズピースにcrownを付与する明確な目標

**実装複雑度**: 中。現在のデッキ内の最大ブロック数を計算する処理が必要。

---

### P16: 火花ブロック (spark)

| 項目 | 値 |
|---|---|
| type | `spark` |
| name | 火花ブロック |
| symbol | ✦ |
| isNegative | false |
| 効果タイミング | 消去時 |
| ショップ出現 | 可能 |
| description | 消去時30%の確率で列点+5 |

**効果詳細**: 消去対象にsparkパターンのセルが含まれる場合、30%の確率で列点(B)に+5を加算する。外れた場合は効果なし。multiシール付きsparkは2回抽選（どちらか当選すれば+5）。

**デザイン意図**: luckyパターン（10%で列点×2）の「マイルド版」。確率は高いが効果は固定値。luckyが「一発逆転」型なのに対し、sparkは「コツコツ型」。

**シナジー**:
- 幸運のお守り(R34) → sparkの確率も上昇するか要検討（lucky専用ならシナジーなし）
- flame(P09: 列点に2^n加算) → sparkの+5にflameの2^nが加算されるB側強化ビルド
- ギャンブラー(R38: 50%で×3) → 確率系パターンを重ねる「運任せビルド」

**実装複雑度**: 低。lucky判定と同様のランダム処理。

---

### P17: 鏡ブロック (mirror)

| 項目 | 値 |
|---|---|
| type | `mirror` |
| name | 鏡ブロック |
| symbol | 🪞 |
| isNegative | false |
| 効果タイミング | 消去時 |
| ショップ出現 | 可能 |
| description | 隣接するパターンブロックの効果をコピーして追加発動 |

**効果詳細**: 消去対象のmirrorセルに上下左右で隣接する消去対象セルのうち、パターンを持つセルの効果をコピーして発動する（mirror自体はスコアに直接寄与しない）。コピーは隣接する1セルにつき1回。同じパターンが複数隣接していても各々コピーされる。multiシール付きmirrorはコピー効果が2倍。

例: mirrorの右にenhancedがある → ブロック点+2が追加発動（実質enhanced2個分）
例: mirrorの上にmoss、右にenhanced → moss効果+enhanced効果が追加発動

**デザイン意図**: 「パターンの増幅器」。鏡をどの位置に置くかで効果が変わるため、配置計画の深さが増す。コピーレリック（既存）のパターン版。

**シナジー**:
- enhanced/aura/combo等全パターン → 隣接配置で効果が倍増
- crystal(P04: 交差点で+10) → mirrorの隣にcrystalを交差点に置けばコピーで+20
- 紋様蒐集家(R01: パターン種類数×3) → mirror自体もパターンとしてカウント

**実装複雑度**: 高。各パターンの効果を動的にコピーするロジックが必要。パターン効果計算の一般化が必要。

---

### P18: 触媒ブロック (catalyst)

| 項目 | 値 |
|---|---|
| type | `catalyst` |
| name | 触媒ブロック |
| symbol | ⚗️ |
| isNegative | false |
| 効果タイミング | 消去時 |
| ショップ出現 | 可能 |
| description | 自身はブロック点に寄与しないが、他パターンの効果を1.5倍にする |

**効果詳細**: catalystパターンのセルは消去時のbaseBlocksから除外される（chargeと同様の扱い）。ただし消去対象に含まれる他のパターン効果（enhanced, aura, charge, combo, moss, flame等）の数値を全て1.5倍（切捨て）にする。catalystが複数あっても倍率は1.5倍のまま（重複しない）。multiシール付きで1.5→2.0倍。

例: enhanced(+2)がcatalystと同時消去 → +2×1.5 = +3
例: charge(蓄積値5)がcatalystと同時消去 → 5×1.5 = +7

**デザイン意図**: 自分自身のスコア貢献を犠牲にして他のパターンを強化する「サポーター」型。パターン付きブロックが多い消去ほど恩恵が大きい。

**シナジー**:
- enhanced/charge/combo等 → catalyst1つで全パターンが1.5倍
- 紋様共鳴(R33: 同パターン3+で列点×2) → catalyst+同パターン3つで効果1.5倍+列点×2
- コンボチェーン(R37: combo計算3^n-1) → comboの3^n-1がさらに1.5倍

**実装複雑度**: 中。PatternEffectHandlerでcatalyst判定後にボーナス値を乗算する処理を追加。

---

### P19: 虹ブロック (rainbow)

| 項目 | 値 |
|---|---|
| type | `rainbow` |
| name | 虹ブロック |
| symbol | 🌈 |
| isNegative | false |
| 効果タイミング | 消去時 |
| ショップ出現 | 可能 |
| description | 消去対象に3種以上のパターンがあれば全パターン効果量+50% |

**効果詳細**: 消去対象セルに含まれるパターンの種類数（rainbow自体を含む）が3種以上ある場合、全パターンの効果量を+50%（1.5倍、切捨て）にする。3種未満の場合は効果なし。catalystとは独立して適用される（両方発動した場合は1.5×1.5=2.25倍）。multiシール付きrainbowでは条件が3→2種に緩和。

例: enhanced + moss + rainbow(3種) → enhancedの+2が+3に、mossの辺数加算が1.5倍に

**デザイン意図**: 紋様蒐集家レリック（パターン種類数×3）の上位版パターン。多様なパターンを集めるビルドの核。catalystが「パターン量」で、rainbowが「パターン多様性」で強化する棲み分け。

**シナジー**:
- 紋様蒐集家(R01: 種類数×3) → rainbow条件の「3種以上」と同じ方向の戦略
- catalyst(P18: 効果1.5倍) → rainbow+catalystで効果2.25倍
- 紋様の護符 → デッキに多様なパターンを付与する動機

**実装複雑度**: 中。catalyst(P18)と同様のボーナス乗算ロジック。発動条件のパターン種類数カウントを追加。

---

### P20: 増幅器ブロック (amplifier)

| 項目 | 値 |
|---|---|
| type | `amplifier` |
| name | 増幅器ブロック |
| symbol | 📡 |
| isNegative | false |
| 効果タイミング | 消去時 |
| ショップ出現 | 可能 |
| description | 同じピースの他ブロックのパターン効果を2倍にする |

**効果詳細**: 消去対象のamplifierセルと同じ`blockSetId`を持つ他の消去対象セルにパターンがある場合、そのパターン効果を2倍にする。amplifier自体のパターン効果はない（増幅のみ）。multiシール付きamplifierは2→3倍に。

例: amplifier + 同ピースのenhanced(+2) → enhanced効果が+4に
例: amplifier + 別ピースのenhanced → 効果なし（同blockSetIdのみ）

**デザイン意図**: multiシール（全パターン効果2倍）のパターン版だが、「同じピース内」に限定されている。大きいピースにamplifier+他パターンの組み合わせで、ピース内シナジーを形成。

**シナジー**:
- 大ピースビルド → 5〜6ブロックのピースにamplifier+enhancedで大きなボーナス
- multiシール → amplifier(2倍)+multi(パターン効果2倍)で実質4倍
- 紋様の護符+造形の護符 → ピースにamplifier+他パターンを付けて最適化

**実装複雑度**: 中。消去対象内のblockSetIdでグループ化し、amplifierを持つグループのパターン効果を乗算。

---

### P21: 金脈ブロック (gold_vein)

| 項目 | 値 |
|---|---|
| type | `gold_vein` |
| name | 金脈ブロック |
| symbol | 💎 |
| isNegative | false |
| 効果タイミング | 消去時 |
| ショップ出現 | 可能 |
| description | 消去時+2G。盤面に3手以上残っていた場合+3G（合計+5G） |

**効果詳細**: gold_veinパターンのセルが消去対象に含まれる場合、ゴールド+2を獲得する。さらに、そのセルが盤面に配置されてから3回以上他のピースが配置された後に消去された場合、追加で+3G（合計+5G）。スコアへの影響はなし（goldシールと同様にゴールド獲得のみ）。multiシール付きで獲得量2倍。

**デザイン意図**: goldシール(+1G)の上位版パターン。パターンはブロック全体に適用されるため、gold_veinの大きいピースは大量のゴールドを生む。「すぐ消す(+2G)」vs「溜めてから消す(+5G)」の選択。

**シナジー**:
- charge（既存: 蓄積型）→ chargeを溜めつつgold_veinの滞在ボーナスも稼ぐ
- 黄金の手(R36: goldシール+3G) → ゴールド特化ビルド
- ゴールドラッシュ(R23: ライン消去でゴールド) → 経済ビルドの柱

**実装複雑度**: 中。Cellに配置ターン数またはカウンターを追加。charge蓄積と類似のアーキテクチャ。

---

### P22: 宝箱ブロック (treasure)

| 項目 | 値 |
|---|---|
| type | `treasure` |
| name | 宝箱ブロック |
| symbol | 📦 |
| isNegative | false |
| 効果タイミング | 消去時 |
| ショップ出現 | 可能 |
| description | 消去時にランダムで1〜5Gを獲得 |

**効果詳細**: treasureパターンのセルが消去対象に含まれる場合、1〜5Gの範囲でランダムにゴールドを獲得する。各treasureセルごとに独立して判定される。multiシール付きで獲得量2倍。スコアには影響しない。

期待値: セルあたり平均+3G（1+2+3+4+5の平均）

**デザイン意図**: gold_vein(確実だが条件あり)に対して、treasure(無条件だがランダム)。「ギャンブル経済」パターン。

**シナジー**:
- ギャンブラー(R38: 50%で列点×3) → 運任せビルドの経済パーツ
- 幸運のお守り(R34) → 確率系全般の仲間
- 経済ビルド全般 → 安定収入のgold_vein vs 変動収入のtreasure

**実装複雑度**: 低。ランダム判定でゴールド加算するだけ。lucky判定と類似。

---

### P23: 種ブロック (seed)

| 項目 | 値 |
|---|---|
| type | `seed` |
| name | 種ブロック |
| symbol | 🌱 |
| isNegative | false |
| 効果タイミング | 消去後（ボード状態変更） |
| ショップ出現 | 可能 |
| description | 消去後、隣接する空きマスに「芽」を残す。芽の上に配置するとパターン効果UP |

**効果詳細**: seedパターンのセルが消去された後、そのセルに上下左右で隣接する空きマスに「芽マーカー」(`hasSprout: true`)を設定する。芽マーカーのあるセルにブロックを配置した場合、そのブロックのパターン効果が1.5倍になる（パターンがない場合はブロック点+2のenhanced効果を付与）。芽マーカーは使用されると消える。multiシール付きseedは芽マーカーの効果が2.0倍に。

**デザイン意図**: shadow(P05: 影マーカーでブロック点+3)の発展系。shadowが「消去位置に配置すると+3」なのに対し、seedは「消去位置の隣に配置するとパターン強化」。範囲が広い分、効果は条件付き。

**シナジー**:
- shadow(P05) → 影マーカー+芽マーカーのボード管理ビルド
- enhanced → 芽の上にenhancedを置くと+2が1.5倍=+3
- charge → 芽の上にchargeを置くとcharge蓄積値が1.5倍

**実装複雑度**: 中〜高。Cellに`hasSprout`プロパティ追加。配置時のパターン効果乗算ロジック。shadow(P05)と同様のアーキテクチャ。

---

### P24: 揮発ブロック (volatile)

| 項目 | 値 |
|---|---|
| type | `volatile` |
| name | 揮発ブロック |
| symbol | 💨 |
| isNegative | false |
| 効果タイミング | 消去時 + 配置後（時間制約） |
| ショップ出現 | 可能 |
| description | 消去時ブロック点+6。ただし配置後2手以内に消去しないと消滅 |

**効果詳細**: volatileパターンのセルは配置時にカウンター0で開始し、他のピースが配置されるたびにカウンターが+1される。カウンターが2を超えた時点で、volatileセルは自動的に`filled: false`になる（消去扱いではなく消滅＝スコアに寄与しない）。2手以内にライン消去の対象になった場合、通常通り消去されブロック点(A)に+6が加算される。multiシール付きで+12。

**デザイン意図**: 「速攻」を促す時限パターン。配置後すぐにラインを完成させないと消えてしまう緊張感。charge（溜めるほど強い）の正反対の時間軸。

**シナジー**:
- feather（重ね置き）→ volatileを隙間に置いてすぐラインを完成
- nohand → ハンドを消費せずにvolatileを配置し、残りハンドでライン完成
- 連射ビルド → 毎手消去の戦略でvolatileの期限切れを防ぐ

**実装複雑度**: 中。charge蓄積と同様のカウンター管理+消滅判定ロジック。

---

### P25: 粘土ブロック (clay)

| 項目 | 値 |
|---|---|
| type | `clay` |
| name | 粘土ブロック |
| symbol | 🟤 |
| isNegative | false |
| 効果タイミング | 配置後（時間経過で変化） |
| ショップ出現 | 可能 |
| description | 配置後、消去されずに1手経過するとenhancedパターンに変化 |

**効果詳細**: clayパターンのセルは配置時点ではパターン効果なし。配置後に1回以上他のピースが配置されても消去されなかった場合、セルのパターンが`enhanced`に変化する（`chargeValue`等は保持）。変化後は通常のenhancedとして扱われる（ブロック点+2）。multiシール付きの場合、変化後のenhanced効果も2倍化。

**デザイン意図**: 「待つ」ことで価値が上がるパターン。配置直後は効果なしだが、1手待つとenhancedに「成長」する。volatile（速攻型）と対照的。charge（蓄積型）ともenhancedへの確定変化という点で異なる。

**シナジー**:
- 忍耐(R14: 3手溜めてから消去で×3) → 忍耐の溜め期間中にclayがenhancedに変化
- 紋様共鳴(R33: 同パターン3+で列点×2) → clay3つが全てenhancedに変化して条件達成
- amplifier(P20: 同ピースの効果2倍) → amplifier+clayピースで変化後の効果が2倍

**実装複雑度**: 中。charge蓄積と類似のカウンター+パターン変化ロジック。

---

### P26: 茨ブロック (thorns)

| 項目 | 値 |
|---|---|
| type | `thorns` |
| name | 茨ブロック |
| symbol | 🌹 |
| isNegative | false |
| 効果タイミング | 配置時 + 消去時 |
| ショップ出現 | 可能 |
| description | 配置時ハンドを2消費。消去時ブロック点+8 |

**効果詳細**: thornsパターンのピースを配置すると、通常の1ハンドに加えて追加で1ハンドを消費する（合計2ハンド消費）。nohandパターンと共存する場合はnohandが優先され、ハンド消費なしになる。消去時にはブロック点(A)に+8を加算する。multiシール付きで+16。

**デザイン意図**: ハンド消費増のデメリットと高ブロック点のメリットを天秤にかけるリスク/リワードパターン。enhanced(+2)の4倍の効果だが、ハンドが2倍消費される。

**シナジー**:
- nohand → thorns+nohandでデメリットを完全に無効化しつつ+8を獲得（強力な組み合わせ）
- bandaid（既存: 3ハンドごとにnohandモノミノ）→ thornsのハンド消費をbandaidで補填
- hand_plus(R26: ハンド+2) → thornsのデメリットを緩和

**実装複雑度**: 低。配置時のハンド消費計算にthorns判定を追加するだけ。

---

### P27: 錆ブロック (rust)

| 項目 | 値 |
|---|---|
| type | `rust` |
| name | 錆ブロック |
| symbol | 🟫 |
| isNegative | true |
| 効果タイミング | 常時（盤面存在中） |
| ショップ出現 | 不可（ボスラウンドなどシステム配置） |
| description | このブロックと同じ行/列にあるブロックのパターン効果を無効化する |

**効果詳細**: rustパターンのセルが盤面にfilled状態で存在する間、同じ行および同じ列にある全セルのパターン効果が無効化される（消去時のパターン効果計算でスキップされる）。rustセル自体はobstacleと異なりライン消去で消去可能。消去されればパターン無効化も解除される。

**デザイン意図**: obstacle（消去不可）の代替ネガティブパターン。obstacleは「物理的にラインを塞ぐ」が、rustは「ラインは完成するがパターン効果を殺す」。ラインは消せるがスコアが低くなるジレンマ。obstacleとは異なる種類のプレッシャーを提供。

**ショップ不出現の理由**: ネガティブパターンのため、ボスラウンドの特殊条件で配置。

**シナジー**:
- bomb(P01: 追加消去) → bombでrustを巻き込んで消去し、パターン効果を解放
- ice(P10) + rust → ボスラウンドの複合障害として

**実装複雑度**: 中〜高。消去時のパターン効果計算で、rust行/列のフィルタリング処理が必要。

---

### P28: 位相ブロック (phase)

| 項目 | 値 |
|---|---|
| type | `phase` |
| name | 位相ブロック |
| symbol | 🫥 |
| isNegative | false |
| 効果タイミング | 配置時 |
| ショップ出現 | 可能 |
| description | obstacleブロックの上に重ねて配置可能（obstacleを置き換える） |

**効果詳細**: phaseパターンのピースは、通常は配置不可能なobstacleパターンのセルの上に配置可能。配置時にobstacleセルを上書きし、phaseブロックで置き換える。featherパターン（通常ブロックの上に重ね置き）と同様の配置制約緩和だが、対象がobstacle限定。phaseブロック自体はスコアに直接影響しない（配置制約緩和のみ）。

**デザイン意図**: ボスラウンドのobstacle条件に対するカウンター。featherが「通常ブロックの上」に重ね置きするのに対し、phaseは「obstacleの上」に置き換える。ボス戦対策として戦略的に購入する動機。

**シナジー**:
- ボスラウンド(obstacle条件) → ボス対策の切り札
- feather → featherは通常ブロック上、phaseはobstacle上で役割分担
- セカンドチャンス(R28) → ボスラウンドの安全策としてphase+セカンドチャンス

**実装複雑度**: 低〜中。`canPlacePiece`のobstacle判定にphaseパターンの例外処理を追加。featherの実装と類似。

---

### P29: ワープブロック (warp)

| 項目 | 値 |
|---|---|
| type | `warp` |
| name | ワープブロック |
| symbol | 🌀 |
| isNegative | false |
| 効果タイミング | 配置時 |
| ショップ出現 | 可能 |
| description | ボードの端からはみ出して配置可能（はみ出し部分は反対側に回り込む） |

**効果詳細**: warpパターンのピースは、ボードの端からはみ出す位置に配置可能。はみ出した部分は反対側のマスに回り込んで配置される（トーラス的接続）。右端からはみ出すと左端に、下端からはみ出すと上端に回り込む。回り込み先のセルが既にfilledの場合は配置不可。スコアへの直接的影響はない。

例: 横向きドミノを列5に配置 → 1セルは列5、もう1セルは列0に配置

**デザイン意図**: 配置の自由度を劇的に変えるルール変更パターン。6×6の小さなボードで、端と端が繋がることで新しい配置パターンが生まれる。台本レリックの指定ラインが端にある場合、warpで裏側からアクセスする戦略。

**シナジー**:
- moss → warpで端に回り込んだブロックも端接触辺をカウント
- 台本(script) → 端のラインに回り込み配置でアクセス
- エッジランナー(R03: 外周ブロック+2) → warpで意図的に外周に配置

**実装複雑度**: 高。座標のモジュロ演算による回り込み処理。CollisionServiceの大幅な拡張が必要。ライン消去判定への影響も要検討。

---

### P30: 共鳴ブロック (resonance)

| 項目 | 値 |
|---|---|
| type | `resonance` |
| name | 共鳴ブロック |
| symbol | 〜 |
| isNegative | false |
| 効果タイミング | 消去時 |
| ショップ出現 | 可能 |
| description | 同時に消去されるシール付きブロック1つにつきブロック点+3 |

**効果詳細**: 消去対象にresonanceパターンのセルが含まれる場合、消去対象の中でシール（gold, score, multi, arrow_v, arrow_h）を持つセルの数をカウントし、`シール付きセル数 × 3` をブロック点(A)に加算する。resonanceが複数あっても加算は1回。multiシール付きで加算量2倍。

例: 消去対象にシール付きブロックが3個 → ブロック点+9

**デザイン意図**: パターンとシールの橋渡しをする「シナジー型」パターン。通常パターンとシールは独立して効果を発揮するが、resonanceが存在することでシール付きブロックの価値がA側でも上がる。

**シナジー**:
- 印章蒐集家(R02: シール種類数×5) → シールの多様性+resonanceの数量で二重ボーナス
- multiシール → multi自体がシールとしてresonanceのカウント対象+パターン効果2倍化
- 刻印の護符 → デッキにシールを増やす動機がresonanceで倍増

**実装複雑度**: 低。消去対象セルのシール有無をカウントするだけ。

---

## 更新: パターン分類サマリー

### 既存パターン（9種）+ 新パターン（30種）= 全39種

| 分類 | 既存 | 新規P01-P10 | 新規P11-P30 |
|---|---|---|---|
| A加算（基本） | enhanced, aura, combo | crystal, link | heavy, resonance |
| A加算（盤面状態依存） | charge | vine, harvest | fertile, hollow |
| A加算（条件付き） | — | prism, echo | — |
| B加算 | moss, lucky | flame | beacon, crown, spark |
| メタパターン（他効果強化） | — | — | mirror, catalyst, rainbow, amplifier |
| ボード状態変更 | — | bomb, shadow | seed |
| 経済（ゴールド） | — | — | gold_vein, treasure |
| 時間制約/変化 | — | — | volatile, clay |
| 配置ルール変更 | feather, nohand | — | phase, warp, thorns |
| ネガティブ | obstacle | ice | rust |

---

## 更新: 実装優先度の提案

### Phase 1: シンプルなスコア系（既存アーキテクチャで実装可能）
- **P02 prism** — PatternEffectHandlerにライン数参照を追加するだけ
- **P04 crystal** — completedLinesとセル位置の照合のみ
- **P09 flame** — comboBonusとほぼ同じロジック
- **P11 fertile** — 消去後の空きマスカウント
- **P12 hollow** — 隣接空きセルチェック（auraと類似）
- **P13 heavy** — placedBlockSize参照
- **P16 spark** — lucky判定と類似のランダム処理
- **P30 resonance** — シール付きセル数カウント

### Phase 2: 状態管理が必要なもの
- **P08 harvest** — harvestCounterの追加
- **P03 echo** — 前回スコアの保持
- **P06 vine** — 配置時の隣接カウント計算
- **P14 beacon** — 盤面filledセル数カウント
- **P15 crown** — デッキ内最大ブロック数参照
- **P21 gold_vein** — 配置ターンカウンター
- **P22 treasure** — ランダムゴールド判定
- **P24 volatile** — 消滅カウンター管理
- **P25 clay** — パターン変化ロジック
- **P26 thorns** — ハンド消費計算の変更

### Phase 3: ボード状態変更・メタパターン系
- **P05 shadow** — Cellプロパティ追加、消去後/配置時の処理
- **P07 link** — 隣接ペアカウントのグラフ探索
- **P18 catalyst** — パターン効果乗算処理
- **P19 rainbow** — パターン種類数カウント+効果乗算
- **P20 amplifier** — blockSetId別のパターン効果乗算
- **P23 seed** — 芽マーカー管理

### Phase 4: 消去/配置ロジック大幅変更系
- **P01 bomb** — 消去対象セル収集の拡張
- **P10 ice** — 消去判定の分岐、iceCrackedフラグ
- **P17 mirror** — パターン効果の動的コピー
- **P27 rust** — 行列単位のパターン効果無効化
- **P28 phase** — obstacle上配置の例外処理
- **P29 warp** — 座標モジュロ演算、配置ロジック大幅変更
